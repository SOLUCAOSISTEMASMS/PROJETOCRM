{% extends 'base.html' %}
{% block titulo %}Funcionários{% endblock %}
{% block conteudo %}
<div class="container mt-4">
  <form method="GET" action="/listar_funcionarios" class="mb-4 d-flex">
    <input type="text" name="filtro" class="form-control me-2" placeholder="Buscar por nome ou email...">
    <button type="submit" class="btn btn-primary">
      <i class="fas fa-search"></i> Buscar
    </button>
    <a href="/exportar_funcionarios" class="btn btn-outline-secondary ms-2">
      <i class="fas fa-file-export me-1"></i> Exportar CSV
    </a>
  </form>

  <div class="d-flex justify-content-between align-items-center mb-4">
    <h3>Lista de Funcionários</h3>
    <a href="/criar_usuario" class="btn btn-success">
      <i class="bi bi-person-plus"></i> Novo Funcionário
    </a>
  </div>

  {% if funcionarios %}
    <table class="table table-hover table-bordered shadow">
  <thead class="table-dark">
    <tr>
      <th>Nome</th>
      <th>Login</th>
      <th>Email</th>
      <th>Tipo</th>
      <th>Status</th>
      <th>Ações</th>
    </tr>
  </thead>
  <tbody>
    {% for u in funcionarios %}

    <tr>
      <td>{{ u.nome }}</td>
      <td>{{ u.nome_usuario }}</td>
      <td>{{ u.email }}</td>
      <td><span class="badge bg-info text-dark">{{ u.tipo }}</span></td>
      <td>
        {% if u.ativo %}
          <span class="badge bg-success">Ativo</span>
        {% else %}
          <span class="badge bg-secondary">Inativo</span>
        {% endif %}
      </td>
      <td>
        <a href="/editar_permissao/{{ u.id }}" class="btn btn-sm btn-primary">
          <i class="fas fa-user-shield"></i> Permissão
        </a>
        <a href="/alternar_status/{{ u.id }}" class="btn btn-sm {% if u.ativo %}btn-warning{% else %}btn-success{% endif %}">
          {% if u.ativo %}Suspender{% else %}Reativar{% endif %}
        </a>
      </td>
    </tr>
    {% endfor %}
  </tbody>
</table>
  {% else %}
    <div class="alert alert-warning">Nenhum funcionário cadastrado ainda.</div>
  {% endif %}
</div>
{% endblock %}
